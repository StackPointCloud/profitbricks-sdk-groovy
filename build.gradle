apply plugin: 'groovy'
apply plugin: 'maven-publish'

group 'com.profitbricks.sdk'
version '3.0-SNAPSHOT'

targetCompatibility = 8

repositories {
    mavenCentral()
    jcenter()
}

task sourceJar(type: Jar) {
    //noinspection GrUnresolvedAccess, GroovyAssignabilityCheck
    from sourceSets.main.allGroovy
}

publishing {
    publications {
        mavenJava(MavenPublication) {
            from components.java

            //noinspection GroovyAssignabilityCheck
            artifact sourceJar {
                classifier 'sources'
            }
        }
    }
    repositories {
        maven {
            url 'http://artifacts.stage.pb.local/content/repositories/snapshots'
        }
    }
}

dependencies {
    testCompile 'org.spockframework:spock-core:+'
    runtime     'org.apache.logging.log4j:log4j-jcl:2.+'
    compile     'org.codehaus.groovy:groovy-all:2.4.+',
                'org.codehaus.groovy.modules.http-builder:http-builder:+',
                'org.codehaus.gpars:gpars:+',
                'org.apache.logging.log4j:log4j-core:2.+'
}

test {
    ['user', 'password', 'URL'].each {
        systemProperty "api.${it}", System.getProperty("api.${it}")
    }
    systemProperty "api.verifySSL", false
}

publish.dependsOn publishToMavenLocal
